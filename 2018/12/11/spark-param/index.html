<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Spark 常用参数设置 - Hello World</title><meta name=author content="Shell Ming"><meta name=description content="A blog about everything."><meta name=generator content="Hugo 0.52"><link rel=stylesheet href=/assets/css/external.min.css media=screen><link rel=stylesheet href=/assets/css/styles.css media=screen><link href="//fonts.googleapis.com/css?family=Roboto:400" rel=stylesheet><link rel=apple-touch-icon-precomposed sizes=144x144 href=/assets/img/apple-touch-icon.png><link rel="shortcut icon" href=/assets/img/favicon.ico><link href=/posts/index.xml rel=alternate type=application/rss+xml title="Hello World"><link href=/posts/index.xml rel=feed type=application/rss+xml title="Hello World"><meta property=og:title content="Spark 常用参数设置"><meta property=og:description content="记录一些常用的必须要设置的参数
num-executors  说明：该参数用于设置Spark作业总共要用多少个Executor进程来执行 建议：设置的太少，无法充分利用集群资源；设置的太多的话，大部分队列可能无法给予充分的资源。建议 50~100个  .executor-cores  说明：用于设置每个Executor进程的CPU core数量。 建议：如果设置过少（例如设为1），无法发挥单个 work 进程的并发能力，如果设置过大，如果有 HDFS 的 IO 操作，会使单个节点网络压力较大。建议设为 2~4  .executor-memory  说明：该参数用于设置每个Executor进程的内存。 建议：每个Executor进程的内存设置4G~8G较为合适。  .driver-memory  说明：该参数用于设置Driver进程的内存。 建议：如果有大的 collect 操作的话，需要设大一点，保证 Driver 内存能装得下  .spark.default.parallelism  说明：该参数用于设置每个stage的默认task数量。 建议：设置该参数为num-executors * executor-cores的2~3倍较为合适  .yarn.executor.directMemoryOverhead / .yarn.driver.directMemoryOverhead  说明：控制 Driver 和 Executor 的 Direct memory ，如果执行过程中出现 direct memory oom 异常，可以将这两个值适当调大一些 建议：默认为 256m ，建议 512m  补充说明 Direct memory 也叫做 off heap memory， 是在 jvm heap 之外的由操作系统直接管理的本地内存。 也就是说，这部分内存并不会被 jvm 的拉圾回收器管理。 jvm 本身有参数 MaxDirectMemorySize 控制 jvm 进程能用的最大的 offheap 内存，超出这个内存就会报出 Direct memory oom 。由于 Spark 本质上也是分布式的 jvm 程序，所以 direct memory 的最大使用量也最终由这个参数控制。 在Spark中，direct memory分为三部分： - jvmOverhead jvmOverhead 是 jvm 自身一些lib库，以及线程栈, 内部数据结构占用的堆外内存 - directMemoryOverhead directMemoryOverhead 是 spark 框架本身进行一些网络 io 操作/文件 io 操作/ execution(shuffle,join等)/storage(cache 数据)使用的堆外内存 - otherOverhead otherOverhead 是其他的一些框架占用的direct内存，比如 HBase，或者用户代码中使用的堆外内存，默认大小为0，一般可以忽略。"><meta property=og:type content=article><meta property=og:url content=https://shellming.github.io/2018/12/11/spark-param/><meta property=article:published_time content=2018-12-11T00:00:00&#43;00:00><meta property=article:modified_time content=2018-12-11T00:00:00&#43;00:00><meta itemprop=name content="Spark 常用参数设置"><meta itemprop=description content="记录一些常用的必须要设置的参数
num-executors  说明：该参数用于设置Spark作业总共要用多少个Executor进程来执行 建议：设置的太少，无法充分利用集群资源；设置的太多的话，大部分队列可能无法给予充分的资源。建议 50~100个  .executor-cores  说明：用于设置每个Executor进程的CPU core数量。 建议：如果设置过少（例如设为1），无法发挥单个 work 进程的并发能力，如果设置过大，如果有 HDFS 的 IO 操作，会使单个节点网络压力较大。建议设为 2~4  .executor-memory  说明：该参数用于设置每个Executor进程的内存。 建议：每个Executor进程的内存设置4G~8G较为合适。  .driver-memory  说明：该参数用于设置Driver进程的内存。 建议：如果有大的 collect 操作的话，需要设大一点，保证 Driver 内存能装得下  .spark.default.parallelism  说明：该参数用于设置每个stage的默认task数量。 建议：设置该参数为num-executors * executor-cores的2~3倍较为合适  .yarn.executor.directMemoryOverhead / .yarn.driver.directMemoryOverhead  说明：控制 Driver 和 Executor 的 Direct memory ，如果执行过程中出现 direct memory oom 异常，可以将这两个值适当调大一些 建议：默认为 256m ，建议 512m  补充说明 Direct memory 也叫做 off heap memory， 是在 jvm heap 之外的由操作系统直接管理的本地内存。 也就是说，这部分内存并不会被 jvm 的拉圾回收器管理。 jvm 本身有参数 MaxDirectMemorySize 控制 jvm 进程能用的最大的 offheap 内存，超出这个内存就会报出 Direct memory oom 。由于 Spark 本质上也是分布式的 jvm 程序，所以 direct memory 的最大使用量也最终由这个参数控制。 在Spark中，direct memory分为三部分： - jvmOverhead jvmOverhead 是 jvm 自身一些lib库，以及线程栈, 内部数据结构占用的堆外内存 - directMemoryOverhead directMemoryOverhead 是 spark 框架本身进行一些网络 io 操作/文件 io 操作/ execution(shuffle,join等)/storage(cache 数据)使用的堆外内存 - otherOverhead otherOverhead 是其他的一些框架占用的direct内存，比如 HBase，或者用户代码中使用的堆外内存，默认大小为0，一般可以忽略。"><meta itemprop=datePublished content=2018-12-11T00:00:00&#43;00:00><meta itemprop=dateModified content=2018-12-11T00:00:00&#43;00:00><meta itemprop=wordCount content=109><meta itemprop=keywords content=ufs,防火墙,DoS,安全,><meta name=twitter:card content=summary><meta name=twitter:title content="Spark 常用参数设置"><meta name=twitter:description content="记录一些常用的必须要设置的参数
num-executors  说明：该参数用于设置Spark作业总共要用多少个Executor进程来执行 建议：设置的太少，无法充分利用集群资源；设置的太多的话，大部分队列可能无法给予充分的资源。建议 50~100个  .executor-cores  说明：用于设置每个Executor进程的CPU core数量。 建议：如果设置过少（例如设为1），无法发挥单个 work 进程的并发能力，如果设置过大，如果有 HDFS 的 IO 操作，会使单个节点网络压力较大。建议设为 2~4  .executor-memory  说明：该参数用于设置每个Executor进程的内存。 建议：每个Executor进程的内存设置4G~8G较为合适。  .driver-memory  说明：该参数用于设置Driver进程的内存。 建议：如果有大的 collect 操作的话，需要设大一点，保证 Driver 内存能装得下  .spark.default.parallelism  说明：该参数用于设置每个stage的默认task数量。 建议：设置该参数为num-executors * executor-cores的2~3倍较为合适  .yarn.executor.directMemoryOverhead / .yarn.driver.directMemoryOverhead  说明：控制 Driver 和 Executor 的 Direct memory ，如果执行过程中出现 direct memory oom 异常，可以将这两个值适当调大一些 建议：默认为 256m ，建议 512m  补充说明 Direct memory 也叫做 off heap memory， 是在 jvm heap 之外的由操作系统直接管理的本地内存。 也就是说，这部分内存并不会被 jvm 的拉圾回收器管理。 jvm 本身有参数 MaxDirectMemorySize 控制 jvm 进程能用的最大的 offheap 内存，超出这个内存就会报出 Direct memory oom 。由于 Spark 本质上也是分布式的 jvm 程序，所以 direct memory 的最大使用量也最终由这个参数控制。 在Spark中，direct memory分为三部分： - jvmOverhead jvmOverhead 是 jvm 自身一些lib库，以及线程栈, 内部数据结构占用的堆外内存 - directMemoryOverhead directMemoryOverhead 是 spark 框架本身进行一些网络 io 操作/文件 io 操作/ execution(shuffle,join等)/storage(cache 数据)使用的堆外内存 - otherOverhead otherOverhead 是其他的一些框架占用的direct内存，比如 HBase，或者用户代码中使用的堆外内存，默认大小为0，一般可以忽略。"></head><body><nav><a href=/>Shell Ming</a></nav><main class=container><article><header><small><time datetime="2018-12-11 12:00">2018-12-11</time>
&bull;
<a href=/categories/development>DEVELOPMENT</a></small><h1>Spark 常用参数设置</h1></header><section><p>记录一些常用的必须要设置的参数</p><h4 id=num-executors>num-executors</h4><ul><li>说明：该参数用于设置Spark作业总共要用多少个Executor进程来执行</li><li>建议：设置的太少，无法充分利用集群资源；设置的太多的话，大部分队列可能无法给予充分的资源。建议 50~100个</li></ul><h4 id=executor-cores>.executor-cores</h4><ul><li>说明：用于设置每个Executor进程的CPU core数量。</li><li>建议：如果设置过少（例如设为1），无法发挥单个 work 进程的并发能力，如果设置过大，如果有 HDFS 的 IO 操作，会使单个节点网络压力较大。建议设为 2~4</li></ul><h4 id=executor-memory>.executor-memory</h4><ul><li>说明：该参数用于设置每个Executor进程的内存。</li><li>建议：每个Executor进程的内存设置4G~8G较为合适。</li></ul><h4 id=driver-memory>.driver-memory</h4><ul><li>说明：该参数用于设置Driver进程的内存。</li><li>建议：如果有大的 collect 操作的话，需要设大一点，保证 Driver 内存能装得下</li></ul><h4 id=spark-default-parallelism>.spark.default.parallelism</h4><ul><li>说明：该参数用于设置每个stage的默认task数量。</li><li>建议：设置该参数为num-executors * executor-cores的2~3倍较为合适</li></ul><h4 id=yarn-executor-directmemoryoverhead-yarn-driver-directmemoryoverhead>.yarn.executor.directMemoryOverhead / .yarn.driver.directMemoryOverhead</h4><ul><li>说明：控制 Driver 和 Executor 的 Direct memory ，如果执行过程中出现 direct memory oom 异常，可以将这两个值适当调大一些</li><li>建议：默认为 256m ，建议 512m</li></ul><h5 id=补充说明>补充说明</h5><p>Direct memory 也叫做 off heap memory， 是在 jvm heap 之外的由操作系统直接管理的本地内存。 也就是说，这部分内存并不会被 jvm 的拉圾回收器管理。 jvm 本身有参数 <code>MaxDirectMemorySize</code> 控制 jvm 进程能用的最大的 offheap 内存，超出这个内存就会报出 Direct memory oom 。由于 Spark 本质上也是分布式的 jvm 程序，所以 direct memory 的最大使用量也最终由这个参数控制。
在Spark中，direct memory分为三部分：
- jvmOverhead
<code>jvmOverhead</code> 是 jvm 自身一些lib库，以及线程栈, 内部数据结构占用的堆外内存
- directMemoryOverhead
<code>directMemoryOverhead</code> 是 spark 框架本身进行一些网络 io 操作/文件 io 操作/ execution(shuffle,join等)/storage(cache 数据)使用的堆外内存
- otherOverhead
<code>otherOverhead</code> 是其他的一些框架占用的direct内存，比如 HBase，或者用户代码中使用的堆外内存，默认大小为0，一般可以忽略。</p></section><footer><hr><div class=meta><p class=tags><a href=/tags/ufs><span>#</span>ufs</a>
<a href=/tags/%E9%98%B2%E7%81%AB%E5%A2%99><span>#</span>防火墙</a>
<a href=/tags/dos><span>#</span>DoS</a>
<a href=/tags/%E5%AE%89%E5%85%A8><span>#</span>安全</a></p></div><hr><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"test"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></footer></article></main><footer><p>&copy; 2018 Shell Ming. <a href=http://creativecommons.org/licenses/by-sa/4.0/>Some Rights Reserved</a>.</p><p>Powered by <a href=https://gohugo.io title="A Fast and Flexible Website Generator">Hugo</a> &amp; <a href=https://github.com/eshlox/simplicity title="Hugo theme">Simplicity</a>.</p></footer><script src=/assets/js/scripts.min.js></script></body></html>